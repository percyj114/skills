# heartbeat-manager 配置文件
# 邮件凭证（账号、密码、收件人）请配置在 config/.env，不要写在此文件中

# 心跳间隔（分钟）
heartbeat_interval: 30

# ── 邮件 ──────────────────────────────────────
email:
  enabled: true                 # 改为 false 可完全禁用所有邮件功能
  smtp_host: smtp.gmail.com
  smtp_port: 587
  imap_host: imap.gmail.com
  imap_port: 993
  # 高优先级发件人关键词（邮件检查时优先标记，填发件人邮箱的一部分即可）
  high_priority_senders: []

# ── 智能超时分析 ───────────────────────────────
timeout:
  eta_grace_hours: 2            # 超过 eta 多少小时后触发分析
  stale_beats: 3                # 连续 N 个心跳无进展视为卡死
  progress_threshold: 5         # progress 变化低于此值视为无进展

# ── 健康度评分 ─────────────────────────────────
health:
  alert_threshold: 60           # 低于此分数计为低分
  alert_consecutive: 3          # 连续低分次数触发邮件告警

# ── 日志 ───────────────────────────────────────
logging:
  level: INFO
  rotate_days: 7

# ── Git 同步 ───────────────────────────────────
# ⚠️ 警告：git 功能会调用系统 git 命令向远程仓库推送变更，默认关闭。
git:
  enabled: true                 # 本地 eva-shared-memory remote 已配置
  auto_commit: true
  auto_push: true
  commit_prefix: "[heartbeat]"

# ── 网站监控 (v1.1.0) ──────────────────────────
# 自动同步 Canvas 作业截止日期 + FSP 飞行预约到 workspace/upcoming.md
# 需在 config/.env 中配置对应 token；未配置时跳过但不删除现有数据
monitoring:
  canvas:
    enabled: true
    base_url: "https://jhu.instructure.com"
    lookahead_days: 30
  fsp:
    enabled: true
    lookahead_days: 7

# ── 工作区 ─────────────────────────────────────
workspace_dir: workspace

# ── 心跳看门狗 (v1.2.0) ───────────────────────────
# 配合 */15 * * * * cron 使用
# 每次触发先检查距上次心跳时间，未到间隔则静默跳过
watchdog:
  enabled: true
  interval_seconds: 1800    # 期望间隔（30 分钟）
  tolerance_seconds: 90     # 容差（防止边界跳过）
